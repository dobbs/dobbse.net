--- 
layout: post
title: How to stop the next mutation of Sobig.F
date: 2003-08-26T20:02:39
---
<div class="article">
<h1><a href="http://dobbse.net/thinair/2003/08/sobig-f.html">How to stop the next mutation of Sobig.F</a></h1>
<div class="time 2003-08-26T20:02:39 pubdate meta">Tuesday 26 August 2003 at 20:02 </div>
<p>Mixed in with the spam bounces from <a href="http://dobbse.net/thinair/2003/08/000131.html">some vile spammer</a> I'm also getting bounces originating from Sobig F along with lots of mail with attached .pif files.  I know how to stop it.  (spread the word :-)</p>

<p>According to <a href="http://securityresponse.symantec.com/avcenter/venc/data/w32.sobig.f@mm.html">Symantec's security response for Sobig.F</a>

<blockquote><p>Sobig.F can download arbitrary files to an infected computer and execute them. The author of the worm has used this functionality to steal confidential system information and to set up spam relay servers on infected computers.</p>
 
<p>This functionality may also be used as a worm self-update feature. Under the correct conditions, Sobig.F attempts to contact one of the list of master servers, which the author of the worm controls. Then, the worm retrieves a URL that it uses to determine where to get the Trojan file, downloads the Trojan file to the local computer, and then executes it.</p></blockquote>

<p>There are 20 specific computers on the net which Sobig.F will contact to determine the URL of a file to download.  Last week the antivirus community shutdown the 20 servers before any additional damage could be done.  But it didn't take long for some bad guy to introduce <a href="http://www.infoworld.com/article/03/08/26/Time%20Warner%20Telecom%20may%20be%20next%20Sobig.F%20target%20(IDGNS)_1.html">a variant of Sobig.F</a> which addresses this weakness.</p>

<blockquote><p>The new Sobig.F variant contains an encrypted list of the names of seven servers operated by Time Warner Telecom (TWT)... Two of the servers are SMTP ... servers, ... the other five [are] apparently domain name servers.</p></blockquote>

<p>I substantially snipped that quote to draw attention to the use of SMTP and especially DNS.  The new strain no longer hard-codes the ip addresses of a finite number of servers.  Instead it's hard-coded seven domain names.  It implies there will be secondary attacks where the bad guys will crack DNS servers, or more likely Active Directory servers, so that they can control the IP addresses that are mapped to the Time Warner domain names.</p>

<p>The bad guys are breeding a virus that actively looks for mutations of itself.  That ought to scare the hell out of you.</p>

<p><strong>Here's how to stop it.</strong> Sobig is looking to download and execute code from some server.  The mutations are playing games to allow the bad guys to control where that server is.  Use their own code against them.  Change your DNS servers to point the Time Warner addresses (with my apologies to Time Warner)  to a server you control.  Put a Sobig uninstaller there and let the viruses dutifully remove themselves from the infected systems.<p>

<p><strong>That won't be the end of it.</strong>  Viruses and immune systems evolve together.  Every mutation in one creates selective pressures on the other.  This process will continue indefinitely and we are going to see some truly nasty viruses in the future.  <a href="http://weblog.infoworld.com/udell/2003/08/22.html#a779">Microsoft might now be genuinely concerned about tightening their security</a>, but the world is still going to be suffering the consequences of their many years of monopoly laziness for a long time to come.</p>

<p>The best hope we have to limit the damage future viruses can cause is to rebuild our computer world with diverse operating systems and software.  The Windows mono-culture is enormously vulnerable, both for its size and for Microsoft's past sins.  The more Windows users who switch to any other operating system the better.  We can pretty much count on the fact that not everyone is going to switch.  So there's little danger that some other OS will take Window's place.  Optimistically, if Windows were only 30% of the market with Solaris, Mac OS, Linux, FreeBSD, OpenBSD, and others splitting the rest of the market, we'd be in a much better position as far as viruses are concerned.</p>

<p>Here's an incentive to you reluctant Windows users: you can switch today and live in a much less hostile computing ecosystem.</p>

</div>
