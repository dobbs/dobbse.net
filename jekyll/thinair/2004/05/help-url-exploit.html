<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Mac OS X security exploit and countermeasure (thinair)</title>
<link rel="alternate" type="application/rss+xml" title="thinair feed" href="http://dobbse.net/index.rdf" />
<link rel="stylesheet" href="http://dobbse.net/style.css" type="text/css" />
<link rel="start" href="http://dobbse.net/" title="Home" />
<link rel="prev" href="http://dobbse.net/thinair/2004/05/db-analysis.html" title="3D change:  analyzing 12 years of backup data" />

<link rel="next" href="http://dobbse.net/thinair/2004/05/DomainKeys.html" title="Yahoo! DomainKeys anti-spam measure" />

</head>
<body>

<div class="header">
<h1><a href="/">thinair</a></h1>
<div class="hgroup">
<h2 class="first">Boulder, Colorado</h2>
<h2>elevation 5400 feet</h2>
<h2>your guide: Eric Dobbs</h2>
</div>
</div>


<div class="article">
<h1><a href="http://dobbse.net/thinair/2004/05/help-url-exploit.html">Mac OS X security exploit and countermeasure</a></h1>
<div class="time 2004-05-18T23:06:55 pubdate meta">Tuesday 18 May 2004 at 23:06 </div>
<p>Thanks to <a href="http://osx.hyperjeff.net/">Jeff</a> for posting this info on the <a href="http://comug.com">COMUG</a> mailing list and thanks also to to <a href="http://simon.incutio.com/archive/2004/05/18/defending">Simon&#39;s other pointers regarding the Mac OS X help url exploit</a>.  <strong>Update:</strong>  It is important that you follow this procedure for each user on your Mac -- the protocol helper preferences are stored separately for each user (more details at the bottom).</p>

<p>Mac <span class="caps">OS X</span> handles various <span class="caps">UR</span>Ls specially.  By default &#39;help&#39; urls are handled by Apple&#39;s Help Viewer which has the feature of allowing you to run an arbitrary script or shell command.  See Simon&#39;s post for links to harmless examples of the exploit, links to more detailed discussion, and to his preferred fix.</p>

<p>The countermeasure is to change the application that handles &#39;help&#39; urls to something other than Help Viewer.  The fixes Jeff and Simon pointed to both require downloads, and from reading the more detailed discussion, I think Simon&#39;s is a more complete solution.  But it turns out you don&#39;t have to download anything, though I had to swallow a little pride.</p>

<p>Internet Explorer allows you to change the protocol helpers for the <span class="caps">OS.</span></p>

<p>The fix is very easy.  Here&#39;s the very granular step-by-step instructions (don&#39;t be daunted by the number of steps -- I described every button click :-).  I tested this with <span class="caps">OS X 10.3.3</span> and <span class="caps">IE 5.2.3 </span>-- the steps might differ on other versions.</p>

<ol><li>Launch Internet Explorer.</li>
<li>From the <strong>Explorer* menu select *Preferences...</strong>.</li>
<li>In the left hand window pane, under the <strong>Network* section, select *Protocol Helpers</strong>.</li>
<li>In the right hand window pane, select the <strong>help</strong> protocol.</li>
<li>Click the <strong>Change...</strong> button (a Protocol Helper Editor window will appear).</li>
<li>Click the <strong>Choose Helper...</strong> (the Open dialog box will appear).</li>
<li>Choose an application other than <strong>Help Viewer* -- I chose *TextEdit</strong>.</li>
<li>Click the <strong>Open</strong> button (which will return you to the Protocol Helper Editor window).</li>
<li>Confirm that there&#39;s a check in the <strong>Use current application if possible</strong> checkbox.</li>
<li>Click the <strong>OK</strong> button (which will return you to the Preferences window).</li>
<li>Click the <strong>OK</strong> button (which will close the Preferences window).</li>
</ol>

<p>Simon&#39;s post also mentions creating a helper for the &#39;disk&#39; protocol.  The Finder will happily mount remote disk images from a <span class="caps">URL</span> which could be used in a two-part exploit: in one link you would mount a nasty script in a known location on the victim&#39;s computer via the &#39;disk&#39; url and in the other link you would use the &#39;help&#39; url to launch that nasty script.  However, &#39;ftp&#39; urls will also be mounted by the Finder, and I&#39;m fairly sure that the .Mac iDisk uses a &#39;webdav&#39; url.  There may well be others I don&#39;t know about.  Disabling the &#39;help&#39; url vulnerability will at least prevent a link on a web page from launching a nasty script.  Breaking those other urls is more than I&#39;m willing to do on my own system.  Having said that, expect to see some social engineering emails trying to get clicking assistance from naive Mac users.</p>

<p><strong>Update:</strong> Another member of <span class="caps">COMUG, </span>Dan Oetting mentioned in another email that these preferences need to be set for each user.  So I dug a little harder to see where they might be stored.  It looks like they are here:  ~/Library/Preferences/com.apple.internetconfig.plist.  That might open the possibility of creating a script to change the settings if you have a lot of macs to fix.  It&#39;s not a trivial change because the values of the protocol helpers are stored in some encoded format.</p>

<p>Quick <span class="caps">XML</span> rant:  what is the point of using an <span class="caps">XML</span> file for preferences if you&#39;re going to store values using some other encoded format?  If Apple had gone a little further xml-ifying the Internet Config preferences file, someone would already have written the script to automate the change for networks of many computers, or Macs with many user accounts.</p>

</div>

<div class="section comments"><a name="comments"></a>

</div>


<div class="nav">
<ol>
<li>Archives
  <ol>
    <li><a href="http://dobbse.net/thinair/2011/01/index.html">January 2011</a></li>
    <li><a href="http://dobbse.net/thinair/2010/12/index.html">December 2010</a></li>
    <li><a href="http://dobbse.net/thinair/2010/09/index.html">September 2010</a></li>
    <li><a href="http://dobbse.net/thinair/2010/08/index.html">August 2010</a></li>
    <li><a href="http://dobbse.net/thinair/2010/06/index.html">June 2010</a></li>
    <li><a href="http://dobbse.net/thinair/2010/02/index.html">February 2010</a></li>
    <li><a href="http://dobbse.net/thinair/2009/10/index.html">October 2009</a></li>
    <li><a href="http://dobbse.net/thinair/2009/09/index.html">September 2009</a></li>
    <li><a href="http://dobbse.net/thinair/2009/07/index.html">July 2009</a></li>
    <li><a href="http://dobbse.net/thinair/2009/05/index.html">May 2009</a></li>
    <li><a href="http://dobbse.net/thinair/2009/03/index.html">March 2009</a></li>
    <li><a href="http://dobbse.net/thinair/2009/02/index.html">February 2009</a></li>
    <li><a href="http://dobbse.net/thinair/2009/01/index.html">January 2009</a></li>
    <li><a href="http://dobbse.net/thinair/2008/12/index.html">December 2008</a></li>
    <li><a href="http://dobbse.net/thinair/2008/09/index.html">September 2008</a></li>
    <li><a href="http://dobbse.net/thinair/2007/10/index.html">October 2007</a></li>
    <li><a href="http://dobbse.net/thinair/2007/09/index.html">September 2007</a></li>
    <li><a href="http://dobbse.net/thinair/2007/08/index.html">August 2007</a></li>
    <li><a href="http://dobbse.net/thinair/2007/06/index.html">June 2007</a></li>
    <li><a href="http://dobbse.net/thinair/2007/04/index.html">April 2007</a></li>
    <li><a href="http://dobbse.net/thinair/2007/03/index.html">March 2007</a></li>
    <li><a href="http://dobbse.net/thinair/2007/01/index.html">January 2007</a></li>
    <li><a href="http://dobbse.net/thinair/2006/12/index.html">December 2006</a></li>
    <li><a href="http://dobbse.net/thinair/2006/11/index.html">November 2006</a></li>
    <li><a href="http://dobbse.net/thinair/2006/10/index.html">October 2006</a></li>
    <li><a href="http://dobbse.net/thinair/2006/09/index.html">September 2006</a></li>
    <li><a href="http://dobbse.net/thinair/2006/08/index.html">August 2006</a></li>
    <li><a href="http://dobbse.net/thinair/2006/07/index.html">July 2006</a></li>
    <li><a href="http://dobbse.net/thinair/2006/06/index.html">June 2006</a></li>
    <li><a href="http://dobbse.net/thinair/2006/04/index.html">April 2006</a></li>
    <li><a href="http://dobbse.net/thinair/2006/02/index.html">February 2006</a></li>
    <li><a href="http://dobbse.net/thinair/2005/12/index.html">December 2005</a></li>
    <li><a href="http://dobbse.net/thinair/2005/10/index.html">October 2005</a></li>
    <li><a href="http://dobbse.net/thinair/2005/06/index.html">June 2005</a></li>
    <li><a href="http://dobbse.net/thinair/2005/05/index.html">May 2005</a></li>
    <li><a href="http://dobbse.net/thinair/2005/04/index.html">April 2005</a></li>
    <li><a href="http://dobbse.net/thinair/2005/03/index.html">March 2005</a></li>
    <li><a href="http://dobbse.net/thinair/2005/02/index.html">February 2005</a></li>
    <li><a href="http://dobbse.net/thinair/2004/12/index.html">December 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/11/index.html">November 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/10/index.html">October 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/09/index.html">September 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/08/index.html">August 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/07/index.html">July 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/06/index.html">June 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/05/index.html">May 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/04/index.html">April 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/03/index.html">March 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/02/index.html">February 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2004/01/index.html">January 2004</a></li>
    <li><a href="http://dobbse.net/thinair/2003/12/index.html">December 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/11/index.html">November 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/10/index.html">October 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/09/index.html">September 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/08/index.html">August 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/07/index.html">July 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/06/index.html">June 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/05/index.html">May 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/04/index.html">April 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/03/index.html">March 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/02/index.html">February 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2003/01/index.html">January 2003</a></li>
    <li><a href="http://dobbse.net/thinair/2002/12/index.html">December 2002</a></li>
    <li><a href="http://dobbse.net/thinair/2002/11/index.html">November 2002</a></li>
    <li><a href="http://dobbse.net/thinair/2002/10/index.html">October 2002</a></li>
    <li><a href="http://dobbse.net/thinair/2002/09/index.html">September 2002</a></li>
    <li><a href="http://dobbse.net/thinair/2001/01/index.html">January 2001</a></li>

  </ol>
</li>

<li>Around
  <ol class="wide">
    <li><a href="http://dobbse.net/thinair/2004/05/db-analysis.html">&laquo; 3D change:  analyzing 12 years of backup data</a></li>

    <li><a href="http://dobbse.net/thinair/2004/05/DomainKeys.html">&raquo; Yahoo! DomainKeys anti-spam measure</a></li>

  </ol>
</li>

</ol>
</div>
<div class="footer meta">
All content &copy; 2001-2011  Eric Dobbs unless otherwise noted.  All rights reserved.
</div>

</body>
</html>
